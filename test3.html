<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Allpree Stories</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: sans-serif;
    }
    .swiper {
      width: 100vw;
      height: 100vh;
    }
    .swiper-slide {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      background: #000;
      color: #fff;
    }
    .slide-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
      pointer-events: auto;
      z-index: 20;
    }
    .cta-button {
      margin: 10px;
      padding: 15px 25px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      pointer-events: auto !important;
      z-index: 30 !important;
    }
    .cta-link {
      background-color: gold;
      color: #000;
    }
    .cta-jump {
      background-color: red;
      color: #fff;
    }
    .tap-zone {
      position: absolute;
      width: 50%;
      height: 100%;
      top: 0;
      z-index: 10;
      pointer-events: auto;
    }
    .tap-left {
      left: 0;
    }
    .tap-right {
      right: 0;
    }
    .progress-bar-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      display: flex;
      gap: 2px;
      padding: 5px;
      z-index: 25;
    }
    .progress-bar {
      flex: 1;
      height: 4px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 2px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      width: 0%;
      background: white;
      transition: width 0.3s;
    }
  </style>
</head>
<body>
  <div class="swiper">
    <div class="swiper-wrapper" id="story-wrapper">
      <!-- Slides will be injected here -->
    </div>
    <div class="tap-zone tap-left"></div>
    <div class="tap-zone tap-right"></div>
    <div class="progress-bar-container" id="progress-container"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    const storyData = [
      {
        title: "Slide 1",
        content: "Welcome to Allpree Stories!",
        ctaLink: "https://example.com",
        jumpToIndex: null,
      },
      {
        title: "Slide 2",
        content: "Check out our latest offers!",
        ctaLink: null,
        jumpToIndex: 3,
      },
      {
        title: "Slide 3",
        content: "This is more info before jump...",
        ctaLink: null,
        jumpToIndex: null,
      },
      {
        title: "Slide 4",
        content: "You jumped here!",
        ctaLink: "https://allpree.com",
        jumpToIndex: null,
      }
    ];

    const swiper = new Swiper(".swiper", {
      direction: "horizontal",
      allowTouchMove: false,
      speed: 300,
    });

    const wrapper = document.getElementById("story-wrapper");
    const progressContainer = document.getElementById("progress-container");

    storyData.forEach((slide, index) => {
      const slideEl = document.createElement("div");
      slideEl.className = "swiper-slide";
      slideEl.innerHTML = `
        <div class="slide-overlay">
          <h2>${slide.title}</h2>
          <p>${slide.content}</p>
          ${slide.ctaLink ? `<button class="cta-button cta-link" onclick="window.open('${slide.ctaLink}', '_blank')">Learn More</button>` : ""}
          ${slide.jumpToIndex !== null ? `<button class="cta-button cta-jump" onclick="jumpTo(${slide.jumpToIndex})">Next Story</button>` : ""}
        </div>
      `;
      wrapper.appendChild(slideEl);

      const bar = document.createElement("div");
      bar.className = "progress-bar";
      bar.innerHTML = `<div class="progress-fill" id="progress-${index}"></div>`;
      progressContainer.appendChild(bar);
    });

    function jumpTo(index) {
      swiper.slideTo(index);
    }

    function updateProgress(index) {
      for (let i = 0; i < storyData.length; i++) {
        const fill = document.getElementById(`progress-${i}`);
        if (i < index) fill.style.width = "100%";
        else if (i === index) fill.style.width = "50%";
        else fill.style.width = "0%";
      }
    }

    document.querySelector(".tap-left").addEventListener("click", () => {
      const prev = swiper.activeIndex - 1;
      if (prev >= 0) swiper.slideTo(prev);
    });

    document.querySelector(".tap-right").addEventListener("click", () => {
      const next = swiper.activeIndex + 1;
      if (next < storyData.length) swiper.slideTo(next);
    });

    swiper.on("slideChange", () => updateProgress(swiper.activeIndex));
    updateProgress(0);
  </script>
</body>
</html>
